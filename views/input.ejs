<% layout('layout') %>

<section style="padding: 60px 0 40px 0; text-align: left;">
    <div style="display: inline-block; background: #eff6ff; color: var(--accent); padding: 6px 16px; border-radius: 99px; font-size: 0.75rem; font-weight: 800; text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 15px;">
        Konfigurasi Sistem
    </div>
    <h1 style="font-size: 2.8rem; font-weight: 800; letter-spacing: -0.04em; color: var(--primary); margin: 0 0 10px 0; line-height: 1.2;">
        Input Data <span style="color: var(--accent);">Produksi.</span>
    </h1>
    <p style="font-size: 1.1rem; color: #64748b; max-width: 650px;">
        Masukkan detail elemen kerja untuk menghitung efisiensi lintasan secara otomatis.
    </p>
</section>

<div style="background: #ffffff; border-radius: 24px; border: 1px solid #e2e8f0; box-shadow: 0 20px 40px rgba(0, 0, 0, 0.04); overflow: hidden; margin-bottom: 100px;">
    <div style="height: 6px; background: linear-gradient(90deg, var(--accent) 0%, #60a5fa 100%);"></div>
    
    <form action="/calculate" method="POST" id="analysisForm" style="padding: 40px;">
        
        <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px; margin-bottom: 40px;">
            <div style="background: #f8fafc; padding: 20px; border-radius: 16px; border: 1px solid #f1f5f9;">
                <label style="display: block; font-weight: 800; font-size: 0.7rem; color: #94a3b8; text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 10px;">Identitas Proyek</label>
                <input type="text" name="projectName" placeholder="Nama Proyek Analisis" required 
                    style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 0.95rem; font-family: inherit; box-sizing: border-box;">
            </div>
            <div style="background: #f8fafc; padding: 20px; border-radius: 16px; border: 1px solid #f1f5f9;">
                <label style="display: block; font-weight: 800; font-size: 0.7rem; color: #94a3b8; text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 10px;">Metode</label>
                <select name="mode" id="modeSelect" onchange="toggleTaktInput()" 
                    style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 12px; font-size: 0.95rem; font-family: inherit; font-weight: 700; cursor: pointer;">
                    <option value="actual">Aktual (Bottleneck)</option>
                    <option value="target">Target (Takt Time)</option>
                </select>
            </div>
        </div>

        <div id="taktInputContainer" style="display: none; background: #eff6ff; padding: 25px; border-radius: 20px; border: 1px solid #dbeafe; margin-bottom: 40px;">
            <label style="display: block; font-weight: 800; font-size: 0.75rem; color: var(--accent); text-transform: uppercase; margin-bottom: 8px;">Input Takt Time (Detik)</label>
            <input type="number" name="taktTime" step="0.001" placeholder="0.000" style="width: 100%; padding: 12px; border: 1px solid #bfdbfe; border-radius: 10px; font-size: 1rem; font-weight: 700; color: var(--accent);">
        </div>

        <div style="margin-bottom: 20px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3 style="font-size: 1.2rem; font-weight: 800; color: var(--primary);">Daftar Elemen Kerja</h3>
                <button type="button" onclick="addStationRow()" style="background: var(--accent); color: white; border: none; padding: 10px 20px; border-radius: 10px; font-size: 0.85rem; font-weight: 700; cursor: pointer;">+ Tambah Elemen</button>
            </div>

            <div id="stationFields">
                <div style="display: grid; grid-template-columns: 50px 3fr 1fr 50px; gap: 15px; margin-bottom: 10px; padding: 0 15px;">
                    <span style="font-size: 0.65rem; font-weight: 800; color: #cbd5e1; text-transform: uppercase;">ID</span>
                    <span style="font-size: 0.65rem; font-weight: 800; color: #cbd5e1; text-transform: uppercase;">Deskripsi Tugas</span>
                    <span style="font-size: 0.65rem; font-weight: 800; color: #cbd5e1; text-transform: uppercase;">Waktu (s)</span>
                    <span></span>
                </div>

                <div class="station-row" style="display: grid; grid-template-columns: 50px 3fr 1fr 50px; gap: 15px; margin-bottom: 12px; align-items: center; background: #f8fafc; padding: 12px 15px; border-radius: 12px; border: 1px solid #f1f5f9;">
                    <div class="row-number" style="font-weight: 800; color: var(--accent); font-size: 0.9rem; text-align: center;">1</div>
                    <input type="text" name="s_name[]" placeholder="Deskripsi Tugas" required 
                        style="padding: 10px; border: 1px solid #e2e8f0; border-radius: 8px; font-family: inherit; font-size: 0.9rem; box-sizing: border-box;">
                    <input type="number" name="s_time[]" step="0.001" placeholder="0.00" required 
                        style="padding: 10px; border: 1px solid #e2e8f0; border-radius: 8px; font-family: inherit; font-size: 0.9rem; font-weight: 700; color: var(--accent); text-align: center; box-sizing: border-box;">
                    <div style="width: 32px;"></div>
                </div>
            </div>
        </div>

        <button type="submit" style="width: 100%; margin-top: 30px; background: var(--primary); color: white; border: none; padding: 18px; border-radius: 14px; font-size: 1rem; font-weight: 800; cursor: pointer; transition: 0.3s;">
            SIMPAN & PROSES DATA
        </button>
    </form>
</div>

<script>
    function toggleTaktInput() {
        const mode = document.getElementById('modeSelect').value;
        const container = document.getElementById('taktInputContainer');
        container.style.display = (mode === 'target') ? 'block' : 'none';
    }

    function updateRowNumbers() {
        const rows = document.querySelectorAll('.station-row');
        rows.forEach((row, index) => {
            row.querySelector('.row-number').innerText = index + 1;
        });
    }

    function addStationRow() {
        const container = document.getElementById('stationFields');
        const div = document.createElement('div');
        div.className = "station-row";
        // Inline style dipastikan identik dengan baris pertama
        div.style = "display: grid; grid-template-columns: 50px 3fr 1fr 50px; gap: 15px; margin-bottom: 12px; align-items: center; background: #f8fafc; padding: 12px 15px; border-radius: 12px; border: 1px solid #f1f5f9;";
        
        div.innerHTML = `
            <div class="row-number" style="font-weight: 800; color: var(--accent); font-size: 0.9rem; text-align: center;"></div>
            <input type="text" name="s_name[]" placeholder="Deskripsi Tugas" required 
                style="padding: 10px; border: 1px solid #e2e8f0; border-radius: 8px; font-family: inherit; font-size: 0.9rem; box-sizing: border-box;">
            <input type="number" name="s_time[]" step="0.001" placeholder="0.00" required 
                style="padding: 10px; border: 1px solid #e2e8f0; border-radius: 8px; font-family: inherit; font-size: 0.9rem; font-weight: 700; color: var(--accent); text-align: center; box-sizing: border-box;">
            <button type="button" onclick="this.parentElement.remove(); updateRowNumbers();" 
                style="background: none; border: none; color: #ef4444; cursor: pointer; font-size: 1.2rem; font-weight: bold;">&times;</button>
        `;
        container.appendChild(div);
        updateRowNumbers();
    }
</script>